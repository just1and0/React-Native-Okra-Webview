{"version":3,"sources":["build-with-short-url.tsx"],"names":["BuildWithShortUrl","props","short_url","onSuccess","onClose","onError","BeforeClose","toggleModal","setToggleModal","isLoading","setIsLoading","onTransactionSuccess","res","status","onTransactionClose","onTransactionError","onTransactionBeforeClose","messageReceived","data","webResponse","JSON","parse","event","onNavigationStateChange","state","url","includes","flex","html","e","nativeEvent","backgroundColor","justifyContent","alignItems","paddingVertical","flexDirection","paddingHorizontal","color","fontWeight","alignSelf"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { View, Modal, SafeAreaView, ActivityIndicator, TouchableOpacity, Text } from 'react-native'\nimport { OkraBuildWithShortUrlProps } from './types';\nimport { WebView, WebViewNavigation } from 'react-native-webview';\nimport { ShortUrlWebViewConfig } from './webview-config';\n\nconst BuildWithShortUrl = (props: OkraBuildWithShortUrlProps) => {\n    const { short_url, onSuccess, onClose, onError, BeforeClose } = props;\n\n    const [toggleModal, setToggleModal] = useState(true)\n    const [isLoading, setIsLoading] = useState(true);\n\n    const onTransactionSuccess = (res: any) => {\n        setToggleModal(false)\n\n        onSuccess({ status: 'options success', res })\n        setToggleModal(false)\n    }\n\n    const onTransactionClose = () => {\n        onClose({ status: 'options close' })\n        setToggleModal(false)\n    }\n\n    const onTransactionError = (res: any) => {\n        onError && onError({ status: 'options error', res })\n        setToggleModal(false)\n    }\n\n    const onTransactionBeforeClose = () => {\n        BeforeClose && BeforeClose()\n        setToggleModal(false)\n    }\n\n    const messageReceived = (data: string) => {\n        const webResponse = JSON.parse(data);\n\n        switch (webResponse.event) {\n            case 'option success':\n                onTransactionSuccess(webResponse)\n                break;\n\n            case 'option close':\n                onTransactionClose()\n                break;\n\n            case 'option error':\n                onTransactionError(webResponse)\n                setToggleModal(false)\n                break;\n\n            case 'option before close':\n                onTransactionBeforeClose()\n                setToggleModal(false)\n                break;\n\n            default:\n                onTransactionClose()\n                setToggleModal(false)\n                break;\n        }\n    };\n\n    const onNavigationStateChange = (state: WebViewNavigation) => {\n        const { url } = state;\n        if (!url) return;\n        if (url.includes('shouldClose=true')) {\n            onTransactionClose()\n        }\n    };\n\n    return (\n        <View>\n            <Modal visible={toggleModal} animationType={'slide'}>\n                <SafeAreaView style={{ flex: 1 }}>\n                    <WebView\n                        source={{ html: ShortUrlWebViewConfig({ short_url }) }}\n                        onMessage={(e) => {\n                            messageReceived(e.nativeEvent?.data);\n                        }}\n                        onLoadStart={() => setIsLoading(true)}\n                        onLoadEnd={() => setIsLoading(false)}\n                        onNavigationStateChange={onNavigationStateChange}\n                        cacheEnabled={false}\n                        cacheMode={'LOAD_NO_CACHE'}\n                    />\n                    <View style={{ backgroundColor: 'rgb(58, 183, 149)', justifyContent: 'space-between', alignItems: 'center', paddingVertical: 15, flexDirection: 'row' }}>\n                        <View style={{ flex: 1 }}>\n                            {isLoading && (\n                                <View>\n                                    <ActivityIndicator size=\"large\" color={'white'} />\n                                </View>\n                            )}\n                        </View>\n                        <View style={{ flex: 3, paddingHorizontal: 15 }}>\n                            <TouchableOpacity onPress={() => onTransactionClose()}>\n                                <Text style={{ color: 'white', fontWeight: 'bold', alignSelf: 'flex-end' }}>\n                                    close\n                                </Text>\n                            </TouchableOpacity>\n                        </View>\n                    </View>\n                </SafeAreaView>\n            </Modal>\n\n        </View>\n    )\n}\n\nexport default BuildWithShortUrl;\n"]}